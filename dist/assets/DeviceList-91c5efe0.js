import{_ as w,G as g,H as n,I as c,J as r,B as d,P as s,O as m,U as f,S as p,N as x,X as C,F as V,a1 as k,V as I,W as N}from"./index-58fbefeb.js";import{V as b}from"./VContainer-16a83904.js";import{V as L}from"./VRow-e8cc1de5.js";import{g as h}from"./VBtn-e26589fc.js";import{V as _}from"./VCol-1f05323d.js";import{V as S}from"./VChip-c91d595a.js";import{b as B}from"./VProgressCircular-ee66e01e.js";import{V as A}from"./VTable-f7dd46ab.js";import"./index-7bbfa258.js";import"./VAvatar-34608297.js";import"./transition-9537b0c0.js";const D={name:"DeviceList",components:{},setup(){return{stateStore:g()}},data:()=>({showSave:!1}),computed:{},methods:{openBrowser(a){window.open(`http://${a}`)},rescan(){location.reload()},async saveDeviceList(){const a=this.stateStore.serverURL;this.stateStore.nodeQueryList_dump.forEach((i,u)=>{if(i.is_host=="n"){let e={rxId:i.ip,name:"",zoneId:"",zone:"",vwName:"",vwType:""};this.stateStore.rxAssignments.some(o=>o.rxId===e.rxId)||this.stateStore.rxAssignments.push(e)}else if(i.is_host=="y"){let e={txId:i.ip,name:`Video${u+1}`};this.stateStore.txAssignments.some(o=>o.txId===e.txId)||this.stateStore.txAssignments.push(e)}}),await this.stateStore.rxAssignments.sort((i,u)=>{const e=i.rxId.split(".").map(Number),o=u.rxId.split(".").map(Number);for(let t=0;t<4;t++)if(e[t]!==o[t])return e[t]-o[t];return 0}),await this.stateStore.txAssignments.sort((i,u)=>{const e=i.txId.split(".").map(Number),o=u.txId.split(".").map(Number);for(let t=0;t<4;t++)if(e[t]!==o[t])return e[t]-o[t];return 0}),await fetch(`http://${a}/write/UserTvNames/${JSON.stringify(this.stateStore.rxAssignments)}`),await fetch(`http://${a}/write/UserInputNames/${JSON.stringify(this.stateStore.txAssignments)}`),this.$router.push("/")},cancel:function(){this.$router.push("/")}},async created(){this.stateStore.showBottomNav=!1,this.stateStore.showSideMenu=!1,await this.stateStore.getNodeQuery(),this.stateStore.get_UserTvNames(),this.showSave=!0},beforeUnmount(){this.stateStore.showBottomNav=!0}},v=a=>(I("data-v-bce092e1"),a=a(),N(),a),R={class:"d-flex justify-start my-3"},U=v(()=>s("div",{class:"d-flex justify-center"}," 1. Remove duplicate devices as indicated ",-1)),Q=v(()=>s("div",{class:"d-flex justify-center"}," 2. Repeat Device List Scan ",-1)),T=v(()=>s("thead",null,[s("tr",null,[s("th",null,"Device IP"),s("th",null,"MCU Version"),s("th",null,"Firmware Build"),s("th",null,"MAC")])],-1));function j(a,i,u,e,o,t){return n(),c(b,{id:"myContainer",fluid:""},{default:r(()=>[a.showSave?(n(),c(L,{key:0,class:"mx-3"},{default:r(()=>[d(_,null,{default:r(()=>[s("div",R,[d(h,{onClick:t.rescan,color:"blue"},{default:r(()=>[m("ReScan")]),_:1},8,["onClick"])])]),_:1}),e.stateStore.nodeQueryList_ip_duplicates.length!=0?(n(),c(_,{key:0,class:"d-flex flex-column justify-center text-red"},{default:r(()=>[U,Q]),_:1})):(n(),c(_,{key:1,class:"d-flex justify-center"},{default:r(()=>[d(S,{variant:"flat"},{default:r(()=>[m("TX + RX found = "+f(e.stateStore.nodeQueryList_dump.length),1)]),_:1})]),_:1})),d(_,{class:"myCols d-flex justify-end"},{default:r(()=>[d(h,{class:"mx-3",onClick:t.cancel,color:"red"},{default:r(()=>[m("Cancel")]),_:1},8,["onClick"]),e.stateStore.nodeQueryList_ip_duplicates.length==0?(n(),c(h,{key:0,class:"mx-3",onClick:t.saveDeviceList,color:"blue"},{default:r(()=>[m("SAVE")]),_:1},8,["onClick"])):p("",!0)]),_:1})]),_:1})):p("",!0),e.stateStore.showProgress?(n(),c(B,{key:1,id:"progress",indeterminate:"","model-value":"20",size:80,color:"blue"})):p("",!0),d(A,{id:"device-table"},{default:r(()=>[T,s("tbody",null,[(n(!0),x(V,null,C(e.stateStore.nodeQueryList_dump,(l,y)=>(n(),x("tr",{key:y},[s("td",null,[d(S,{class:k(["is_receiver",{is_host:l.is_host=="y"}]),onClick:X=>t.openBrowser(l.ip),variant:"outlined"},{default:r(()=>[m(f(l.is_host=="y"?"TX":"RX")+"-"+f(l.ip),1)]),_:2},1032,["class","onClick"]),e.stateStore.nodeQueryList_ip_duplicates.includes(l.ip)?(n(),c(S,{key:0,color:"red"},{default:r(()=>[m(" Duplicate!")]),_:1})):p("",!0)]),s("td",null,f(l.mcu_version),1),s("td",null,f(l.fw_build),1),s("td",null,f(l.mac),1)]))),128))])]),_:1})]),_:1})}const q=w(D,[["render",j],["__scopeId","data-v-bce092e1"]]);export{q as default};
