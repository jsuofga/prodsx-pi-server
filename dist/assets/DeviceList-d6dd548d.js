import{_ as w,G as g,H as n,I as d,J as a,B as c,P as s,O as m,U as f,S as p,N as v,X as C,F as V,a3 as k,V as I,W as N}from"./index-afea58ed.js";import{V as L}from"./VContainer-e82e0dfa.js";import{V as b}from"./VRow-0a209f09.js";import{g as h}from"./VBtn-3a190bf2.js";import{V as _}from"./VCol-d7f06548.js";import{V as S}from"./VChip-34b17ba6.js";import{b as A}from"./VProgressCircular-8e8a5842.js";import{V as B}from"./VTable-d635230f.js";import"./index-e99edb13.js";import"./VAvatar-5120b031.js";import"./transition-6e06d8f5.js";const D={name:"DeviceList",components:{},setup(){return{stateStore:g()}},data:()=>({showSave:!1}),computed:{},methods:{openBrowser(r){window.open(`http://${r}`)},rescan(){location.reload()},async saveDeviceList(){const r=this.stateStore.serverURL;this.stateStore.nodeQueryList_dump.forEach((i,u)=>{if(i.is_host=="n"){let e={rxId:i.ip,name:"",zoneId:"",zone:"",vwName:"",vwType:""};this.stateStore.rxAssignments.some(o=>o.rxId===e.rxId)||this.stateStore.rxAssignments.push(e)}else if(i.is_host=="y"){let e={txId:i.ip,name:`Video${u+1}`};this.stateStore.txAssignments.some(o=>o.txId===e.txId)||this.stateStore.txAssignments.push(e)}}),await this.stateStore.rxAssignments.sort((i,u)=>{const e=i.rxId.split(".").map(Number),o=u.rxId.split(".").map(Number);for(let t=0;t<4;t++)if(e[t]!==o[t])return e[t]-o[t];return 0}),await this.stateStore.txAssignments.sort((i,u)=>{const e=i.txId.split(".").map(Number),o=u.txId.split(".").map(Number);for(let t=0;t<4;t++)if(e[t]!==o[t])return e[t]-o[t];return 0}),await fetch(`http://${r}/write/UserTvNames/${JSON.stringify(this.stateStore.rxAssignments)}`),await fetch(`http://${r}/write/UserInputNames/${JSON.stringify(this.stateStore.txAssignments)}`),this.$router.push("/")},cancel:function(){this.$router.push("/")}},async created(){this.stateStore.showBottomNav=!1,this.stateStore.showSideMenu=!1,await this.stateStore.getNodeQuery(),this.stateStore.get_UserTvNames(),this.showSave=!0},beforeUnmount(){}},x=r=>(I("data-v-5959da40"),r=r(),N(),r),R={class:"d-flex justify-start my-3"},U=x(()=>s("div",{class:"d-flex justify-center"}," 1. Remove duplicate devices as indicated ",-1)),Q=x(()=>s("div",{class:"d-flex justify-center"}," 2. Repeat Device List Scan ",-1)),T=x(()=>s("thead",null,[s("tr",null,[s("th",null,"Device IP"),s("th",null,"MCU Version"),s("th",null,"Firmware Build"),s("th",null,"MAC")])],-1));function j(r,i,u,e,o,t){return n(),d(L,{id:"myContainer",fluid:""},{default:a(()=>[r.showSave?(n(),d(b,{key:0,class:"mx-3"},{default:a(()=>[c(_,null,{default:a(()=>[s("div",R,[c(h,{onClick:t.rescan,color:"blue"},{default:a(()=>[m("ReScan")]),_:1},8,["onClick"])])]),_:1}),e.stateStore.nodeQueryList_ip_duplicates.length!=0?(n(),d(_,{key:0,class:"d-flex flex-column justify-center text-red"},{default:a(()=>[U,Q]),_:1})):(n(),d(_,{key:1,class:"d-flex justify-center"},{default:a(()=>[c(S,{variant:"flat"},{default:a(()=>[m("TX + RX found = "+f(e.stateStore.nodeQueryList_dump.length),1)]),_:1})]),_:1})),c(_,{class:"myCols d-flex justify-end"},{default:a(()=>[c(h,{class:"mx-3",onClick:t.cancel,color:"red"},{default:a(()=>[m("Cancel")]),_:1},8,["onClick"]),e.stateStore.nodeQueryList_ip_duplicates.length==0?(n(),d(h,{key:0,class:"mx-3",onClick:t.saveDeviceList,color:"blue"},{default:a(()=>[m("SAVE")]),_:1},8,["onClick"])):p("",!0)]),_:1})]),_:1})):p("",!0),e.stateStore.showProgress?(n(),d(A,{key:1,id:"progress",indeterminate:"","model-value":"20",size:80,color:"blue"})):p("",!0),c(B,{id:"device-table"},{default:a(()=>[T,s("tbody",null,[(n(!0),v(V,null,C(e.stateStore.nodeQueryList_dump,(l,y)=>(n(),v("tr",{key:y},[s("td",null,[c(S,{class:k(["is_receiver",{is_host:l.is_host=="y"}]),onClick:X=>t.openBrowser(l.ip),variant:"outlined"},{default:a(()=>[m(f(l.is_host=="y"?"TX":"RX")+"-"+f(l.ip),1)]),_:2},1032,["class","onClick"]),e.stateStore.nodeQueryList_ip_duplicates.includes(l.ip)?(n(),d(S,{key:0,color:"red"},{default:a(()=>[m(" Duplicate!")]),_:1})):p("",!0)]),s("td",null,f(l.mcu_version),1),s("td",null,f(l.fw_build),1),s("td",null,f(l.mac),1)]))),128))])]),_:1})]),_:1})}const q=w(D,[["render",j],["__scopeId","data-v-5959da40"]]);export{q as default};
